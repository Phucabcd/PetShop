<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/index.html::home(~{::body})}"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chi tiết Sản phẩm</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
<div class="container my-3">
    <div class="row mb-5">
        <!-- BREADCRUMB -->
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/quan-tri-he-thong">Trang
                    chủ</a></li>
                <li th:text="${product.productName}" class="breadcrumb-item active"
                    aria-current="page">Tên sản phẩm
                </li>
            </ol>
        </nav>
        <div class="col-lg-6 col-md-12">
            <div class="sticky-top border-dark button-image" style="top: 80px;">
                <img th:src="@{/images/product/{photo}(photo=${product.photo})}"
                     class="img-fluid " alt="Sản phẩm ${product.productName}"
                     style="object-fit: cover; width: 100%; max-height: 800px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);">
                <img src="/images/logo/logo-2.png" alt="logo" class="position-absolute bottom-0 end-0 m-3"
                     style="width: 200px;">
            </div>
        </div>
        <div class="col-lg-6 col-md-12">
            <div class="card shadow p-4 border-0">
                <h1 class="fw-bold mb-3 fs-1" th:text="${product.productName}">Tên
                    sản phẩm</h1>
                <div class="d-flex align-items-center">
                    <h3 class="m-0 text-dark fw-bold text-start"
                        style="text-transform: uppercase">Giá : </h3>
                    <h1 class="color fw-bold fs-1 ms-3"
                        th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT') + 'đ'}">
                        100.000đ</h1>
                </div>
                <div class="mt-3">
                    <h3 class="m-0 color fw-bold text-start" style="text-transform: uppercase">
                        Trạng thái sản phẩm:</h3>
                    <ul class="list-group list-group-flush " style="border-left: 5px solid #dc3545;">
                        <li class="list-group list-group-item ">
                            <div class="d-flex align-items-end">
                                <h5 class="text-muted fw-bold m-0">Tình trạng:</h5>
                                <h3 style="text-decoration: underline" class="fw-bold m-0 ms-2"
                                    th:text="${product.quantity != 0 ? 'Còn hàng' : 'Hết hàng'}"
                                    th:classappend="${product.quantity != 0 ? 'text-success' : 'text-danger'}">
                                </h3>
                            </div>
                        </li>
                        <li class="list-group list-group-item">
                            <div class="d-flex align-items-end">
                                <h5 class="text-muted fw-bold m-0">Số lượng tồn kho:</h5>
                                <h3 style="text-decoration: underline" class="text-primary fw-bold m-0 ms-2"
                                    th:text="${product.quantity}">100</h3>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="mt-3" style="border-left: 5px solid #2e8f24;">
                    <div class="accordion accordion-flush" id="accordionFlushExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#flush-collapseOne" aria-expanded="false"
                                        aria-controls="flush-collapseOne">
                                    <i class="fas fa-check-circle fs-3 text-success me-2"></i>
                                    Giao hàng nhanh chóng
                                </button>
                            </h2>
                            <div id="flush-collapseOne" class="accordion-collapse collapse"
                                 data-bs-parent="#accordionFlushExample">
                                <div class="accordion-body">
                                    Nội dung này mô tả cam kết giao hàng nhanh chóng. Chúng tôi cam kết sẽ giao hàng
                                    trong vòng 24 giờ kể từ khi đặt hàng. Đây là cam kết đầu tiên của chúng tôi về
                                    dịch
                                    vụ.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#flush-collapseTwo" aria-expanded="false"
                                        aria-controls="flush-collapseTwo">
                                    <i class="fas fa-check-circle fs-3 text-success me-2"></i>
                                    Chính sách đổi trả linh hoạt
                                </button>
                            </h2>
                            <div id="flush-collapseTwo" class="accordion-collapse collapse"
                                 data-bs-parent="#accordionFlushExample">
                                <div class="accordion-body">
                                    Chúng tôi cung cấp chính sách đổi trả linh hoạt trong 30 ngày đối với tất cả các
                                    sản
                                    phẩm. Nếu bạn không hài lòng, bạn có thể trả lại sản phẩm và nhận lại tiền.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#flush-collapseThree" aria-expanded="false"
                                        aria-controls="flush-collapseThree">
                                    <i class="fas fa-check-circle fs-3 text-success me-2"></i>
                                    Chất lượng đảm bảo
                                </button>
                            </h2>
                            <div id="flush-collapseThree" class="accordion-collapse collapse"
                                 data-bs-parent="#accordionFlushExample">
                                <div class="accordion-body">
                                    Chúng tôi đảm bảo rằng tất cả các sản phẩm đều đạt chất lượng cao, được kiểm tra
                                    kỹ
                                    lưỡng trước khi giao đến tay khách hàng. Cam kết này mang đến sự an tâm tuyệt
                                    đối
                                    cho người tiêu dùng.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-5">
                    <a th:attr="ng-click=${'cart.add(' + product.id + ')'}"
                       class="btn button-image-white w-100 py-3 rounded-0 bg-danger text-white fw-bold rounded-3"
                       style="background-size: contain; background-repeat: repeat-x;">
                        <h3 class="m-0">
                            Thêm vào giỏ hàng <i class="fas fa-cart-plus"></i>
                        </h3>
                    </a>
                </div>
                <div class="my-3 mt-5">
                    <h3 class="m-0 color fw-bold text-start" style="text-transform: uppercase">MÔ TẢ SẢN PHẨM</h3>
                    <div class="line background-color" style="height: 5px;"></div>
                </div>
                <div>
                    <h4 th:text="${product.productDescription}">Mô tả sản phẩm</h4>
                </div>
                <div class="my-3 mt-5">
                    <h3 class="m-0 color fw-bold text-start" style="text-transform: uppercase">ĐÁNH GIÁ SẢN PHẨM
                        [[${product.productName}]]</h3>
                    <div class="line background-color" style="height: 5px;"></div>
                </div>
                <div style="max-height: 900px; overflow-y: auto; scrollbar-width: thin;">
                    <div th:if="${reviews.size() == 0}" class="text-center">
                        <h4>Chưa có đánh giá nào cho sản phẩm này.</h4>
                    </div>
                    <div th:if="${reviews.size() > 0}"
                         class="d-flex flex-column align-items-center justify-content-center">
                        <h1 style="font-size: 5rem !important;" class="color fw-bold m-0 p-0"
                            th:text="${averageRating}">Đánh giá trung bình</h1>
                        <div class="d-flex flex-column align-items-center justify-content-center">
                            <div class="star-rating">
                                <!-- Ngôi sao đầu 1 -->
                                <span th:if="${averageRating >= 1}" style="color: #FFD700;">&#9733;</span>
                                <span th:if="${averageRating >= 0.5 && averageRating < 1}" style="color: #FFD700;">&#9734;</span>
                                <span th:if="${averageRating < 0.5}" style="color: #E0E0E0;">&#9733;</span>
                                <!-- Ngôi sao thứ 2 -->
                                <span th:if="${averageRating >= 2}" style="color: #FFD700;">&#9733;</span>
                                <span th:if="${averageRating >= 1.5 && averageRating < 2}" style="color: #FFD700;">&#9734;</span>
                                <span th:if="${averageRating < 1.5}" style="color: #E0E0E0;">&#9733;</span>
                                <!-- Ngôi sao thứ 3 -->
                                <span th:if="${averageRating >= 3}" style="color: #FFD700;">&#9733;</span>
                                <span th:if="${averageRating >= 2.5 && averageRating < 3}" style="color: #FFD700;">&#9734;</span>
                                <span th:if="${averageRating < 2.5}" style="color: #E0E0E0;">&#9733;</span>
                                <!-- Ngôi sao thứ 4 -->
                                <span th:if="${averageRating >= 4}" style="color: #FFD700;">&#9733;</span>
                                <span th:if="${averageRating >= 3.5 && averageRating < 4}" style="color: #FFD700;">&#9734;</span>
                                <span th:if="${averageRating < 3.5}" style="color: #E0E0E0;">&#9733;</span>
                                <!-- Ngôi sao thứ 5 -->
                                <span th:if="${averageRating >= 5}" style="color: #FFD700;">&#9733;</span>
                                <span th:if="${averageRating >= 4.5 && averageRating < 5}" style="color: #FFD700;">&#9734;</span>
                                <span th:if="${averageRating < 4.5}" style="color: #E0E0E0;">&#9733;</span>
                            </div>
                            <div class="text-dark fs-4 mb-4">
                                [[${reviews.size()}]] đánh giá
                            </div>
                        </div>
                    </div>
                    <div class="mt-3" th:if="${reviews.size() > 0}">
                        <h3 class="m-0 color fw-bold text-center" style="text-transform: uppercase">ĐÁNH GIÁ TỪ
                            KHÁCH HÀNG</h3>
                    </div>
                    <div th:each="review : ${reviews}" class="my-3" th:if="${reviews.size() > 0}">
                        <div class="card p-3">
                            <div class="d-flex justify-content-start align-items-center">
                                <div>
                                    <i class="fas fa-user fs-3"></i>
                                    <span class="fs-4 fw-bold"
                                          th:text="${review.userName.fullName}">Người dùng</span>
                                </div>
                                <div class="fs-6 ms-3 text-muted">
                                    <span>đã mua sản phẩm <i class="fas fa-check-circle"
                                                             style="color: #2e8f24;"></i>
                                    </span>
                                </div>
                                <div class="star-rating ms-auto">
                                    <span th:if="${review.rating >= 1}" style="color: #FFD700;">&#9733;</span>
                                    <span th:if="${review.rating >= 2}" style="color: #FFD700;">&#9733;</span>
                                    <span th:if="${review.rating >= 3}" style="color: #FFD700;">&#9733;</span>
                                    <span th:if="${review.rating >= 4}" style="color: #FFD700;">&#9733;</span>
                                    <span th:if="${review.rating >= 5}" style="color: #FFD700;">&#9733;</span>
                                    <span th:if="${review.rating < 1}" style="color: #E0E0E0;">&#9733;</span>
                                    <span th:if="${review.rating < 2}" style="color: #E0E0E0;">&#9733;</span>
                                    <span th:if="${review.rating < 3}" style="color: #E0E0E0;">&#9733;</span>
                                    <span th:if="${review.rating < 4}" style="color: #E0E0E0;">&#9733;</span>
                                    <span th:if="${review.rating < 5}" style="color: #E0E0E0;">&#9733;</span>
                                </div>
                            </div>
                            <p class="text-muted" style="font-style: italic"
                               th:text="${#temporals.format(review.reviewDate, 'dd/MM/yyyy HH:mm')}">Ngày
                                đánh giá</p>
                            <div>
                                <span><i class="fa-solid fa-comment-dots fa-flip-horizontal" style="color: #527dd7"></i></span>
                                <span class="p-2">[[${review.comment}]]</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div th:if="${not #lists.isEmpty(relatedProducts)}" class="row g-4 p-3">
    <div class="text-center">
        <div class="my-3 px-2">
            <h1 class="m-0 color fw-bold text-center" style="text-transform: uppercase">CÁC SẢN
                PHẨM THUỘC LOẠI
                [[${product.productCategoryID.productCategoryName}]]</h1>
            <div class="line background-color" style="height: 5px;"></div>
        </div>
        <div class="row">
            <div th:each="product, iterStat : ${relatedProducts}"
                 th:if="${iterStat.index < 6}"
                 class="col-lg-2 col-md-4 col-sm-4 col-6 mb-4">
                <div class="card card-hover border-0">
                    <div class="position-relative button-image add-to-cart-container rounded-4">
                        <div class="overflow-hidden p-0 position-relative">
                            <a class="nav-link"
                               th:href="@{/product/detail/{id}(id=${product.id})}">
                                <div class="overflow-hidden rounded-5">
                                    <img loading="lazy"
                                         th:src="@{/images/product/{photo}(photo=${product.photo})}"
                                         class="card-img-top" alt="product"
                                         style="max-width: 300px; max-height: 300px; object-fit: cover; border-radius: 15px;">
                                </div>
                            </a>
                        </div>

                        <!-- Nút thêm vào giỏ hàng -->
                        <button th:attr="ng-click=${'cart.add(' + product.id + ')'}"
                                class="btn background-color button-image-white add-to-cart w-100 py-3 position-absolute"
                                style="bottom: 0; left: 0; z-index: 1001; border-radius: 15px;">
                            <h5 class="text-white m-0">
                                <span>Thêm vào giỏ</span> <i class="fas fa-cart-plus"></i>
                            </h5>
                        </button>
                    </div>
                    <div class="card-body text-center">
                        <h5 th:text="${product.productName}" class="product-name">Tên
                            sản phẩm</h5>
                        <h4 class="color fw-bold"
                            th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT') + 'đ'}">
                            100.000đ</h4>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div>
    <div class="my-3 px-2">
        <h1 class="m-0 color fw-bold text-center">CÁC SẢN PHẨM KHÁC</h1>
        <div class="line background-color" style="height: 5px;"></div>
    </div>
    <div class="row g-4 p-3">
        <div th:each="product, iterStat : ${otherProducts}"
             th:if="${iterStat.index < 12}"
             class="col-lg-2 col-md-4 col-sm-4 col-6 mb-2">
            <div class="card card-hover border-0">
                <div class="position-relative button-image add-to-cart-container rounded-4">
                    <div class="overflow-hidden p-0 position-relative">
                        <a class="nav-link"
                           th:href="@{/product/detail/{id}(id=${product.id})}">
                            <div class="overflow-hidden rounded-5">
                                <img loading="lazy"
                                     th:src="@{/images/product/{photo}(photo=${product.photo})}"
                                     class="card-img-top" alt="product"
                                     style="max-width: 300px; max-height: 300px; object-fit: cover; border-radius: 15px;">
                            </div>
                        </a>
                    </div>
                    <button th:attr="ng-click=${'cart.add(' + product.id + ')'}"
                            class="btn background-color button-image-white add-to-cart w-100 py-3 position-absolute"
                            style="bottom: 0; left: 0; z-index: 1001; border-radius: 15px;">
                        <h5 class="text-white m-0">
                            <span>Thêm vào giỏ</span> <i class="fas fa-cart-plus"></i>
                        </h5>
                    </button>
                </div>
                <div class="card-body text-center">
                    <h5 th:text="${product.productName}" class="product-name">Tên
                        sản phẩm</h5>
                    <h4 class="color fw-bold"
                        th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT') + 'đ'}">
                        100.000đ</h4>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>